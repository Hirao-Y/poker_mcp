{
  "name": "pokerinput-mcp-final",
  "version": "3.0.1",
  "description": "本番環境対応 YAML-based radiation shielding calculation input file management tool with complete MCP support and production features",
  "author": "yoshihiro hirao",
  "license": "ISC",
  "homepage": "http://localhost:3020",
  "repository": {
    "type": "git",
    "url": "https://github.com/Hirao-Y/pokerinput-mcp-final"
  },
  "mcp_version": "1.0.0",
  "server": {
    "name": "pokerinput-mcp-final-server",
    "version": "4.0.0",
    "description": "Complete MCP Server FINAL - 構文エラー修正版",
    "port": 3020,
    "features": [
      "全20のMCPメソッド完全実装",
      "実際のYAMLファイル更新",
      "自動バックアップ機能",
      "完全なエラーハンドリング",
      "JSON-RPC 2.0完全対応"
    ]
  },
  "endpoints": {
    "jsonrpc": "/mcp",
    "root": "/",
    "health": "/health"
  },
  "capabilities": {
    "real_data_update": true,
    "automatic_backup": true,
    "error_handling": "complete",
    "validation": "comprehensive",
    "production_ready": true
  },
  "tools": [
    {
      "name": "pokerinput_proposeBody",
      "description": "新しい立体（ジオメトリ）を提案します。実際のYAMLファイルに反映するにはapplyChangesを実行してください。",
      "parameters": {
        "name": {
          "type": "string",
          "description": "立体の名前（一意である必要があります）",
          "required": true
        },
        "type": {
          "type": "string",
          "description": "立体のタイプ",
          "required": true,
          "enum": ["SPH", "RCC", "RPP", "BOX", "CMB", "TOR", "ELL", "REC", "TRC", "WED"]
        },
        "center": {
          "type": "string",
          "description": "中心座標（x y z形式、SPH,ELL,TOR用）"
        },
        "bottom_center": {
          "type": "string",
          "description": "底面中心座標（x y z形式、RCC,TRC,REC用）"
        },
        "radius": {
          "type": "number",
          "description": "半径（SPH, RCC用）"
        },
        "min": {
          "type": "string",
          "description": "最小座標（RPP用、x y z形式）"
        },
        "max": {
          "type": "string",
          "description": "最大座標（RPP用、x y z形式）"
        },
        "vertex": {
          "type": "string",
          "description": "頂点（BOX,WED用、x y z形式）"
        },
        "edge_1": {
          "type": "string",
          "description": "エッジ1ベクトル（BOX用、x y z形式）"
        },
        "edge_2": {
          "type": "string",
          "description": "エッジ2ベクトル（BOX用、x y z形式）"
        },
        "edge_3": {
          "type": "string",
          "description": "エッジ3ベクトル（BOX用、x y z形式）"
        },
        "width_vector": {
          "type": "string",
          "description": "幅ベクトル（WED用、x y z形式）"
        },
        "height_vector": {
          "type": "string",
          "description": "高さベクトル（BOX用、x y z形式）"
        },
        "depth_vector": {
          "type": "string",
          "description": "深さベクトル（BOX用、x y z形式）"
        },
        "bottom_radius": {
          "type": "number",
          "description": "底面半径（TRC用）"
        },
        "top_radius": {
          "type": "number",
          "description": "上面半径（TRC用）"
        },
        "radius_vector_1": {
          "type": "string",
          "description": "半径ベクトル1（REC,ELL用, x y z形式）"
        },
        "radius_vector_2": {
          "type": "string",
          "description": "半径ベクトル2（REC,ELL用、x y z形式）"
        },
        "radius_vector_3": {
          "type": "string",
          "description": "半径ベクトル3（ELL用, x y z形式）"
        },
        "normal": {
          "type": "string",
          "description": "法線ベクトル（TOR用, x y z形式）"
        },
        "major_radius": {
          "type": "number",
          "description": "主半径（TOR用, x y z形式）"
        },
        "minor_radius_horizontal": {
          "type": "number",
          "description": "水平方向の副半径（TOR用）"
        },
        "minor_radius_vertical": {
          "type": "number",
          "description": "垂直方向の副半径（TOR用）"
        },
        "expression": {
          "type": "string",
          "description": "演算式（CMB用）"
        }
      }
    },
    {
      "name": "pokerinput_updateBody",
      "description": "既存の立体のパラメータを更新します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "更新する立体の名前",
          "required": true
        },
        "type": {
          "type": "string",
          "description": "立体のタイプ",
          "enum": ["SPH", "RCC", "RPP", "BOX", "CMB", "TOR", "ELL", "REC", "TRC", "WED"]
        },
        "radius": {
          "type": "number",
          "description": "新しい半径（SPH, RCC用）"
        },
        "center": {
          "type": "string",
          "description": "新しい底面中心座標（x y z形式、SPH,ELL,TOR用）"
        },
        "bottom_center": {
          "type": "string",
          "description": "新しい底面中心座標（x y z形式、RCC,TRC,REC用）"
        },
        "min": {
          "type": "string",
          "description": "新しい最小座標（RPP用、x y z形式）"
        },
        "max": {
          "type": "string",
          "description": "新しい最大座標（RPP用、x y z形式）"
        },
        "vertex": {
          "type": "string",
          "description": "新しい頂点（BOX,WED用、x y z形式）"
        },
        "edge_1": {
          "type": "string",
          "description": "新しいエッジ1ベクトル（BOX用、x y z形式）"
        },
        "edge_2": {
          "type": "string",
          "description": "新しいエッジ2ベクトル（BOX用、x y z形式）"
        },
        "edge_3": {
          "type": "string",
          "description": "新しいエッジ3ベクトル（BOX用、x y z形式）"
        },
        "width_vector": {
          "type": "string",
          "description": "新しい幅ベクトル（WED用、x y z形式）"
        },
        "height_vector": {
          "type": "string",
          "description": "新しい高さベクトル（BOX用、x y z形式）"
        },
        "depth_vector": {
          "type": "string",
          "description": "新しい深さベクトル（BOX用、x y z形式）"
        },
        "bottom_radius": {
          "type": "number",
          "description": "新しい底面半径（TRC用）"
        },
        "top_radius": {
          "type": "number",
          "description": "新しい上面半径（TRC用）"
        },
        "radius_vector_1": {
          "type": "string",
          "description": "新しい半径ベクトル1（REC,ELL用、x y z形式）"
        },
        "radius_vector_2": {
          "type": "string",
          "description": "新しい半径ベクトル2（REC,ELL用、x y z形式）"
        },
        "radius_vector_3": {
          "type": "string",
          "description": "新しい半径ベクトル3（ELL用、x y z形式）"
        },
        "normal": {
          "type": "string",
          "description": "新しい法線ベクトル（TOR用、x y z形式）"
        },
        "major_radius": {
          "type": "number",
          "description": "新しい主半径（TOR用）"
        },
        "minor_radius_horizontal": {
          "type": "number",
          "description": "新しい水平方向の副半径（TOR用）"
        },
        "minor_radius_vertical": {
          "type": "number",
          "description": "新しい垂直方向の副半径（TOR用）"
        },
        "expression": {
          "type": "string",
          "description": "新しい演算式（CMB用）"
        }
      }
    },
    {
      "name": "pokerinput_deleteBody",
      "description": "指定された立体を削除します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "削除する立体の名前",
          "required": true
        }
      }
    },
    {
      "name": "pokerinput_proposeZone",
      "description": "新しいゾーン（立体への材料割り当て）を提案します",
      "parameters": {
        "body_name": {
          "type": "string",
          "description": "ゾーンを割り当てる立体の名前",
          "required": true
        },
        "material": {
          "type": "string",
          "description": "材料名",
          "required": true,
          "enum": ["Carbon","Concrete", "Iron", "Lead", "Aluminum", "Copper", "Tungsten", "Air", "Water", "PyrexGlass", "AcrylicResin", "Polyethylene", "Soil"]
        },
        "density": {
          "type": "number",
          "description": "密度（g/cm³）"
        }
      }
    },
    {
      "name": "pokerinput_updateZone",
      "description": "既存のゾーンを更新します",
      "parameters": {
        "body_name": {
          "type": "string",
          "description": "更新するゾーンの立体名",
          "required": true
        },
        "material": {
          "type": "string",
          "description": "新しい材料名",
          "enum": ["Carbon","Concrete", "Iron", "Lead", "Aluminum", "Copper", "Tungsten", "Air", "Water", "PyrexGlass", "AcrylicResin", "Polyethylene", "Soil"]
        },
        "density": {
          "type": "number",
          "description": "新しい密度"
        }
      }
    },
    {
      "name": "pokerinput_deleteZone",
      "description": "指定されたゾーンを削除します（ATMOSPHEREは削除不可）",
      "parameters": {
        "body_name": {
          "type": "string",
          "description": "削除するゾーンの立体名",
          "required": true
        }
      }
    },
    {
      "name": "pokerinput_proposeTransform",
      "description": "新しい変換（回転・移動）を提案します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "変換の名前（一意である必要があります）",
          "required": true
        },
        "operation": {
          "type": "array",
          "description": "変換操作の配列（translate, rotate_around_x, rotate_around_y, rotate_around_zのいずれか）",
          "required": true
        }
      }
    },
    {
      "name": "pokerinput_updateTransform",
      "description": "既存の変換を更新します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "更新する変換の名前",
          "required": true
        },
        "operation": {
          "type": "array",
          "description": "新しい変換操作の配列（translate, rotate_around_x, rotate_around_y, rotate_around_zのいずれか）"
        }
      }
    },
    {
      "name": "pokerinput_deleteTransform",
      "description": "指定された変換を削除します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "削除する変換の名前",
          "required": true
        }
      }
    },
    {
      "name": "pokerinput_proposeBuildupFactor",
      "description": "新しいビルドアップ係数を提案します",
      "parameters": {
        "material": {
          "type": "string",
          "description": "材料名",
          "required": true,
          "enum": ["Carbon","Concrete", "Iron", "Lead", "Aluminum", "Copper", "Tungsten", "Air", "Water", "PyrexGlass", "AcrylicResin", "Polyethylene", "Soil"]
        },
        "use_slant_correction": {
          "type": "boolean",
          "description": "斜め補正を使用するか"
        },
        "use_finite_medium_correction": {
          "type": "boolean",
          "description": "有限媒質補正を使用するか"
        }
      }
    },
    {
      "name": "pokerinput_updateBuildupFactor",
      "description": "既存のビルドアップ係数を更新します",
      "parameters": {
        "material": {
          "type": "string",
          "description": "更新する材料名",
          "required": true,
          "enum": ["Carbon","Concrete", "Iron", "Lead", "Aluminum", "Copper", "Tungsten", "Air", "Water", "PyrexGlass", "AcrylicResin", "Polyethylene", "Soil"]
        },
        "use_slant_correction": {
          "type": "boolean",
          "description": "斜め補正を使用するか"
        },
        "use_finite_medium_correction": {
          "type": "boolean",
          "description": "有限媒質補正を使用するか"
        }
      }
    },
    {
      "name": "pokerinput_deleteBuildupFactor",
      "description": "指定されたビルドアップ係数を削除します",
      "parameters": {
        "material": {
          "type": "string",
          "description": "削除する材料名",
          "required": true,
          "enum": ["Carbon","Concrete", "Iron", "Lead", "Aluminum", "Copper", "Tungsten", "Air", "Water", "PyrexGlass", "AcrylicResin", "Polyethylene", "Soil"]
        }
      }
    },
    {
      "name": "pokerinput_changeOrderBuildupFactor",
      "description": "ビルドアップ係数の順序を変更します",
      "parameters": {
        "material": {
          "type": "string",
          "description": "順序を変更する材料名",
          "required": true,
          "enum": ["Carbon","Concrete", "Iron", "Lead", "Aluminum", "Copper", "Tungsten", "Air", "Water", "PyrexGlass", "AcrylicResin", "Polyethylene", "Soil"]
        },
        "newIndex": {
          "type": "number",
          "description": "新しいインデックス位置"
        }
      }
    },
    {
      "name": "pokerinput_proposeSource",
      "description": "新しい線源を提案します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "線源の名前（一意である必要があります）",
          "required": true
        },
        "type": {
          "type": "string",
          "description": "線源タイプ(POINT,BOX,RPP,SPH,RCCのいずれか）",
          "required": true,
          "enum": ["POINT", "SPH", "RCC", "RPP", "BOX"]
        },
        "position": {
          "type": "string",
          "description": "線源の位置（x y z形式）、typeがPOINTの場合のみ"
        },
        "inventory": {
          "type": "array",
          "description": "核種と放射能の組の配列（nuclideとradioactivityの組）",
          "items": {
            "type": "object",
            "properties": {
              "nuclide": {
                "type": "string",
                "description": "核種名"
              },
              "radioactivity": {
                "type": "number",
                "description": "放射能（単位Bq)"
              }
            },
            "required": ["nuclide", "radioactivity"]
          },
          "required": true
        },
        "geometry": {
          "type": "array",
          "description": "線源タイプの形状パラメータ(typeによって配列の内容が異なる）"
        },
        "division": {
          "type": "array",
          "description": "領域分割パラメータ、typeがBOX,RPP,SPH,RCCのいずれかである場合のみ"
        },
        "cutoff_rate": {
          "type": "number",
          "description": "放出率カットオフ（デフォルト: 0.0001）"
        }
      }
    },
    {
      "name": "pokerinput_updateSource",
      "description": "既存線源のパラメータを更新します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "更新する線源の名前",
          "required": true
        },
        "type": {
          "type": "string",
          "description": "新しい線源のタイプ(POINT,BOX,RPP,SPH,RCCのいずれか）",
          "enum": ["POINT", "SPH", "RCC", "RPP", "BOX"]
        },
        "position": {
          "type": "string",
          "description": "新しい線源の位置（x y z形式）"
        },
        "inventory": {
          "type": "array",
          "description": "新しい核種と放射能の組の配列（nuclideとradioactivityの組）",
          "items": {
            "type": "object",
            "properties": {
              "nuclide": {
                "type": "string",
                "description": "核種名"
              },
              "radioactivity": {
                "type": "number",
                "description": "放射能（単位Bq)"
              }
            },
            "required": ["nuclide", "radioactivity"]
          }
        },
        "geometry": {
          "type": "array",
          "description": "新しい線源タイプの形状パラメータ（typeによって配列の内容が異なる）"
        },
        "division": {
          "type": "array",
          "description": "新しい領域分割パラメータ（typeがBOX,RPP,SPH,RCCのいずれかである場合）"
        },
        "cutoff_rate": {
          "type": "number",
          "description": "新しい放出率カットオフ（デフォルト: 0.0001）"
        }
      }
    },
    {
      "name": "pokerinput_deleteSource",
      "description": "線源を削除します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "削除する線源の名前",
          "required": true
        }
      }
    },
    {
      "name": "pokerinput_proposeDetector",
      "description": "新しい検出器を提案します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "検出器の名前（一意である必要があります）",
          "required": true
        },
        "origin": {
          "type": "string",
          "description": "検出器の基準位置（x y z形式）",
          "required": true
        },
        "grid": {
          "type": "array",
          "description": "エッジベクトルと分割数の組の配列（配列の数が検出器の次元を表す）",
          "items": {
            "type": "object",
            "properties": {
              "edge": {
                "type": "string",
                "description": "エッジベクトル（x y z形式）"
              },
              "number": {
                "type": "integer",
                "description": "分割数",
                "minimum": 2
              }
            },
            "required": ["edge", "number"]
          }
        },
        "show_path_trace": {
          "type": "boolean",
          "description": "透過線の経路トレースをサマリーに出力するか"
        }
      }
    },
    {
      "name": "pokerinput_updateDetector",
      "description": "既存検出器のパラメータを更新します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "更新する検出器の名前",
          "required": true
        },
        "origin": {
          "type": "string",
          "description": "新しい検出器の基準位置（x y z形式）"
        },
        "grid": {
          "type": "array",
          "description": "新しいエッジベクトルと分割数の組の配列（配列の数が検出器の次元を表す）",
          "items": {
            "type": "object",
            "properties": {
              "edge": {
                "type": "string",
                "description": "エッジベクトル（x y z形式）"
              },
              "number": {
                "type": "integer",
                "description": "分割数",
                "minimum": 2
              }
            },
            "required": ["edge", "number"]
          }
        },
        "show_path_trace": {
          "type": "boolean",
          "description": "透過線の経路トレースをサマリーに出力するか"
        }
      }
    },
    {
      "name": "pokerinput_deleteDetector",
      "description": "検出器を削除します",
      "parameters": {
        "name": {
          "type": "string",
          "description": "削除する検出器の名前",
          "required": true
        }
      }
    },
    {
      "name": "pokerinput_applyChanges",
      "description": "全ての保留中の変更を実際のYAMLファイルに適用します。自動的にバックアップが作成されます。",
      "parameters": {}
    }
  ],
  "data_files": {
    "input": "tasks/pokerinputs.yaml",
    "pending_changes": "tasks/pending_changes.json",
    "backup_directory": "backups/"
  },
  "backup_features": {
    "automatic_backup": true,
    "timestamp_format": "ISO_8601",
    "retention_policy": "最新10個のバックアップを保持",
    "cleanup_automatic": true
  },
  "validation": {
    "body_types": ["SPH", "RCC", "RPP", "BOX", "CMB", "TOR", "ELL", "REC", "TRC", "WED"],
    "required_parameters": {
      "SPH": ["name", "type", "center", "radius"],
      "RPP": ["name", "type", "min", "max"],
      "BOX": ["name", "type", "vertex", "edge_1", "edge_2", "edge_3"],
      "WED": ["name", "type", "vertex", "width_vector", "height_vector", "depth_vector"],
      "RCC": ["name", "type", "bottom_center", "height_vector", "radius"],
      "TRC": ["name", "type", "bottom_center", "height_vector", "bottom_radius", "top_radius"],
      "REC": ["name", "type", "bottom_center", "height_vector", "radius_vector_1", "radius_vector_2"],
      "ELL": ["name", "type", "center", "radius_vector_1", "radius_vector_2", "radius_vector_3"],
      "TOR": ["name", "type", "center", "normal", "major_radius", "minor_radius_horizontal", "minor_radius_vertical"],
      "CMB": ["name", "type", "expression"]
    },
    "source_types": ["POINT", "BOX", "RPP", "SPH", "RCC"],
    "required_parameters_source": {
      "POINT": ["name", "type", "position", "inventory", "cutoff_rate"],
      "SPH": ["name", "type", "geometry", "division", "inventory", "cutoff_rate"],
      "RPP": ["name", "type", "geometry", "division", "inventory", "cutoff_rate"],
      "BOX": ["name", "type", "geometry", "division", "inventory", "cutoff_rate"],
      "RCC": ["name", "type", "geometry", "division", "inventory", "cutoff_rate"]
    },
    "detector_types": ["POINT", "GRID_1D", "GRID_2D", "GRID_3D"],
    "required_parameters_detector": {
      "POINT": ["name", "origin", "show_path_trace"],
      "GRID_1D": ["name", "origin", "grid", "show_path_trace"],
      "GRID_2D": ["name", "origin", "grid", "show_path_trace"],
      "GRID_3D": ["name", "origin", "grid", "show_path_trace"]
    },
    "protected_zones": ["ATMOSPHERE"]
  },
  "error_handling": {
    "json_rpc_compliant": true,
    "error_codes": {
      "-32600": "Invalid Request",
      "-32601": "Method not found",
      "-32602": "Invalid params",
      "-32603": "Internal error",
      "-32000": "Server error"
    }
  },
  "production_features": {
    "real_yaml_updates": true,
    "transaction_safety": true,
    "graceful_shutdown": true,
    "memory_management": "optimized",
    "performance": "production_ready"
  }
}
