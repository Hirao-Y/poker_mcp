{
  "name": "pokerinput-mcp-final",
  "version": "4.2.0",
  "description": "YAML-based radiation shielding calculation input file management tool with complete MCP support",
  "author": "Yoshihiro Hirao",
  "license": "ISC",
  "homepage": "http://localhost:3020",
  "repository": {
    "type": "git",
    "url": "https://github.com/Hirao-Y/pokerinput-mcp-final"
  },
  "mcp_version": "4.2.0",
  "server": {
    "name": "pokerinput-mcp-final-server",
    "version": "4.2.0",
    "description": "Complete MCP Server v4.2 - 23メソッド完全実装版",
    "port": 3020,
    "features": [
      "23メソッド完全実装",
      "Body操作系: 作成・更新・削除",
      "Zone操作系: 作成・更新・削除",
      "BuildupFactor操作系: 作成・更新・削除・順序変更",
      "Transform操作系: 作成・更新・削除",
      "Source操作系: 作成・更新・削除",
      "Detector操作系: 作成・更新・削除",
      "立体10タイプ完全対応",
      "材料13種類完全対応",
      "Unit操作系: 作成・更新・取得（削除不可）",
      "単位設定4キー完全性保証 (length, angle, density, radioactivity)",
      "単位データ自動修復機能",
      "読み込み時unit整合性チェック",
      "unit セクション一意性強制",
      "物理係数計算機能強化",
      "依存関係チェック機能",
      "実際のYAMLファイル更新",
      "自動バックアップ・ロールバック機能",
      "完全なエラーハンドリング",
      "JSON-RPC 2.0完全準拠"
    ]
  },
  "endpoints": {
    "jsonrpc": "/mcp",
    "root": "/",
    "health": "/health"
  },
  "capabilities": {
    "real_data_update": true,
    "automatic_backup": true,
    "error_handling": "complete",
    "validation": "comprehensive",
    "production_ready": true,
    "parameter_validation": "enhanced",
    "conditional_parameters": true,
    "structured_geometry": true,
    "structured_division": true,
    "body_operations": true,
    "zone_operations": true,
    "buildup_factor_operations": true,
    "transform_operations": true,
    "source_operations": true,
    "detector_operations": true,
    "dependency_checking": true,
    "order_management": true,
    "unit_operations": true,
    "unit_completeness_guarantee": true,
    "unit_auto_repair": true,
    "unit_validation": "comprehensive",
    "unit_uniqueness_enforcement": true,
    "auto_data_repair": true,
    "unit_section_integrity": "guaranteed",
    "default_value_compensation": true,
    "load_time_validation": true,
    "rollback_support": true,
    "atmosphere_zone_management": true,
    "reserved_keyword_validation": true
  },
  "tools": [
    {
      "name": "pokerinput_proposeBody",
      "description": "新しい3D立体を提案します（自動バックアップ付き）",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "$ref": "#/definitions/object_name",
          "description": "立体の一意な名前（ATMOSPHERE は予約語のため使用不可）"
        },
        "type": {
          "type": "string",
          "description": "立体タイプ",
          "enum": ["SPH", "RCC", "RPP", "BOX", "CMB", "TOR", "ELL", "REC", "TRC", "WED"]
        },
        "center": {
          "$ref": "#/definitions/coordinate_string",
          "description": "中心座標 (x y z形式) - SPH,ELL,TOR用"
        },
        "radius": {
          "$ref": "#/definitions/positive_radius",
          "description": "半径 - SPH, RCC用"
        },
        "bottom_center": {
          "$ref": "#/definitions/coordinate_string",
          "description": "底面中心座標 (x y z形式) - RCC,TRC,REC用"
        },
        "height_vector": {
          "$ref": "#/definitions/coordinate_string",
          "description": "高さベクトル (x y z形式) - RCC,TRC,REC用"
        },
        "min": {
          "$ref": "#/definitions/coordinate_string",
          "description": "最小座標 (x y z形式) - RPP用"
        },
        "max": {
          "$ref": "#/definitions/coordinate_string",
          "description": "最大座標 (x y z形式) - RPP用"
        },
        "vertex": {
          "$ref": "#/definitions/coordinate_string",
          "description": "頂点座標 (x y z形式) - BOX,WED用"
        },
        "edge_1": {
          "$ref": "#/definitions/coordinate_string",
          "description": "エッジ1ベクトル (x y z形式) - BOX用"
        },
        "edge_2": {
          "$ref": "#/definitions/coordinate_string",
          "description": "エッジ2ベクトル (x y z形式) - BOX用"
        },
        "edge_3": {
          "$ref": "#/definitions/coordinate_string",
          "description": "エッジ3ベクトル (x y z形式) - BOX用"
        },
        "expression": {
          "type": "string",
          "description": "集合演算式（CMB用）\n構文: 立体名を演算子で結合\n演算子: + (UNION), - (DIFFERENCE), & (INTERSECTION)\n優先順位: 括弧()で指定可能\n⚠️ 制約: 演算式で参照する立体名は事前に定義済みである必要があります\n例: 'cylinder + sphere', 'box1 - (cylinder & sphere)', '(body1 + body2) - body3'",
          "minLength": 3,
          "maxLength": 500,
          "pattern": "^[a-zA-Z0-9_()\\s+\\-&]+$",
          "constraint": "referenced_bodies_must_exist",
          "validation": {
            "body_existence_check": "演算式内の全立体名存在確認",
            "circular_reference_check": "循環参照の検出",
            "error_on_missing": "-32031エラー"
          }
        },
        "normal": {
          "$ref": "#/definitions/coordinate_string",
          "description": "法線ベクトル (x y z形式) - TOR用"
        },
        "major_radius": {
          "$ref": "#/definitions/positive_radius",
          "description": "主半径 - TOR用"
        },
        "minor_radius_horizontal": {
          "$ref": "#/definitions/positive_radius",
          "description": "水平方向副半径 - TOR用"
        },
        "minor_radius_vertical": {
          "$ref": "#/definitions/positive_radius",
          "description": "垂直方向副半径 - TOR用"
        },
        "radius_vector_1": {
          "$ref": "#/definitions/coordinate_string",
          "description": "半径ベクトル1 (x y z形式) - ELL,REC用"
        },
        "radius_vector_2": {
          "$ref": "#/definitions/coordinate_string",
          "description": "半径ベクトル2 (x y z形式) - ELL,REC用"
        },
        "radius_vector_3": {
          "$ref": "#/definitions/coordinate_string",
          "description": "半径ベクトル3 (x y z形式) - ELL用"
        },
        "bottom_radius": {
          "$ref": "#/definitions/positive_radius",
          "description": "底面半径 - TRC用"
        },
        "top_radius": {
          "$ref": "#/definitions/positive_radius",
          "description": "上面半径 - TRC用"
        },
        "width_vector": {
          "$ref": "#/definitions/coordinate_string",
          "description": "幅ベクトル (x y z形式) - WED用"
        },
        "depth_vector": {
          "$ref": "#/definitions/coordinate_string",
          "description": "奥行きベクトル (x y z形式) - WED用"
        },
        "transform": {
          "$ref": "#/definitions/transform_reference",
          "description": "適用する変換名"
        }
        },
        "required": ["name", "type"],
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_updateBody",
      "description": "既存立体のパラメータを更新します",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "$ref": "#/definitions/object_name",
          "description": "更新する立体名"
        },
        "center": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい中心座標 (x y z形式)"
        },
        "radius": {
          "$ref": "#/definitions/positive_radius",
          "description": "新しい半径"
        },
        "bottom_center": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい底面中心座標 (x y z形式)"
        },
        "height_vector": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい高さベクトル (x y z形式)"
        },
        "min": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい最小座標 (x y z形式)"
        },
        "max": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい最大座標 (x y z形式)"
        },
        "normal": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい法線ベクトル (x y z形式)"
        },
        "major_radius": {
          "$ref": "#/definitions/positive_radius",
          "description": "新しい主半径"
        },
        "minor_radius_horizontal": {
          "$ref": "#/definitions/positive_radius",
          "description": "新しい水平方向副半径"
        },
        "minor_radius_vertical": {
          "$ref": "#/definitions/positive_radius",
          "description": "新しい垂直方向副半径"
        },
        "radius_vector_1": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい半径ベクトル1 (x y z形式)"
        },
        "radius_vector_2": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい半径ベクトル2 (x y z形式)"
        },
        "radius_vector_3": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい半径ベクトル3 (x y z形式)"
        },
        "bottom_radius": {
          "$ref": "#/definitions/positive_radius",
          "description": "新しい底面半径"
        },
        "top_radius": {
          "$ref": "#/definitions/positive_radius",
          "description": "新しい上面半径"
        },
        "width_vector": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい幅ベクトル (x y z形式)"
        },
        "depth_vector": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい奥行きベクトル (x y z形式)"
        },
        "transform": {
          "$ref": "#/definitions/transform_reference",
          "description": "適用する変換名"
        }
        },
        "required": ["name"],
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_deleteBody",
      "description": "立体を削除します（依存関係チェック付き）",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "type": "string",
          "description": "削除する立体名",
          "pattern": "^[a-zA-Z0-9_]+$",
          "maxLength": 50
        }
        },
        "required": ["name"],
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_proposeZone",
      "description": "材料ゾーンを提案します（物理検証付き）",
      "parameters": {
        "type": "object",
        "properties": {
        "body_name": {
          "$ref": "#/definitions/object_name",
          "description": "ゾーンが適用される立体名"
        },
        "material": {
          "$ref": "#/definitions/supported_material",
          "description": "材料名"
        },
        "density": {
          "$ref": "#/definitions/density_value",
          "description": "密度 (g/cm³) - VOID材料では指定禁止、その他材料では必須"
        }
        },
        "required": ["body_name", "material"],
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_updateZone",
      "description": "既存ゾーンの材料や密度を更新します",
      "parameters": {
        "type": "object",
        "properties": {
        "body_name": {
          "type": "string",
          "description": "更新するゾーンの立体名",
          "pattern": "^[a-zA-Z0-9_]+$",
          "maxLength": 50
        },
        "material": {
          "$ref": "#/definitions/supported_material",
          "description": "新しい材料名"
        },
        "density": {
          "type": "number",
          "description": "新しい密度 (g/cm³)",
          "minimum": 0.001,
          "maximum": 30.0
        }
        },
        "required": ["body_name"],
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_deleteZone",
      "description": "ゾーンを削除します（ATMOSPHERE以外）",
      "parameters": {
        "type": "object",
        "properties": {
        "body_name": {
          "type": "string",
          "description": "削除するゾーンの立体名（ATMOSPHERE は削除不可）",
          "pattern": "^[a-zA-Z0-9_]+$",
          "maxLength": 50
        }
        },
        "required": ["body_name"],
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_proposeBuildupFactor",
      "description": "ビルドアップ係数を提案します（物理計算パラメータ付き）",
      "parameters": {
        "type": "object",
        "properties": {
        "material": {
          "$ref": "#/definitions/supported_material",
          "description": "材料名",
          "examples": ["Concrete", "Lead", "Iron"]
        },
        "use_slant_correction": {
          "type": "boolean",
          "description": "スラント補正を使用するか（斜め入射補正）",
          "default": false,
          "note": "高精度計算時に有効"
        },
        "use_finite_medium_correction": {
          "type": "boolean",
          "description": "有限媒体補正を使用するか（境界効果補正）",
          "default": false,
          "note": "薄い遮蔽体での精度向上"
        }
        },
        "required": ["material", "use_slant_correction", "use_finite_medium_correction"],
        "additionalProperties": false
      },
      "validation": {
        "material_uniqueness": "材料の重複チェック",
        "correction_combination": "補正組み合わせの物理妥当性チェック",
        "calculation_impact": "計算コストへの影響評価"
      }
    },
    {
      "name": "pokerinput_updateBuildupFactor",
      "description": "既存ビルドアップ係数の設定を更新します（計算精度パラメータ変更）",
      "parameters": {
        "type": "object",
        "properties": {
        "material": {
          "$ref": "#/definitions/supported_material",
          "description": "更新する材料名",
          "pattern": "^[A-Za-z]+$",
          "maxLength": 20
        },
        "use_slant_correction": {
          "type": "boolean",
          "description": "新しいスラント補正設定（斜め入射時の補正）",
          "note": "変更により計算精度と処理時間が変化"
        },
        "use_finite_medium_correction": {
          "type": "boolean",
          "description": "新しい有限媒体補正設定（境界効果の補正）",
          "note": "薄い遮蔽材での精度向上効果"
        }
        },
        "required": ["material"],
        "additionalProperties": false
      },
      "validation": {
        "existence_check": "材料の存在確認",
        "parameter_combination": "補正パラメータの組み合わせ妥当性",
        "calculation_consistency": "計算設定の一貫性チェック"
      }
    },
    {
      "name": "pokerinput_deleteBuildupFactor",
      "description": "ビルドアップ係数を削除します（計算から除外）",
      "parameters": {
        "type": "object",
        "properties": {
        "material": {
          "$ref": "#/definitions/supported_material",
          "description": "削除する材料名",
          "pattern": "^[A-Za-z]+$",
          "maxLength": 20
        }
        },
        "required": ["material"],
        "additionalProperties": false
      },
      "validation": {
        "existence_check": "ビルドアップ係数の存在確認",
        "usage_dependency": "計算での使用状況チェック",
        "safety_check": "削除の安全性確認"
      }
    },
    {
      "name": "pokerinput_changeOrderBuildupFactor",
      "description": "ビルドアップ係数の計算順序を変更します（物理計算最適化）",
      "parameters": {
        "type": "object",
        "properties": {
        "material": {
          "$ref": "#/definitions/supported_material",
          "description": "順序を変更する材料名",
          "pattern": "^[A-Za-z]+$",
          "maxLength": 20
        },
        "newIndex": {
          "$ref": "#/definitions/buildup_index",
          "description": "新しいインデックス位置（0から開始）",
          "note": "小さい値ほど優先度が高い"
        }
        },
        "required": ["material", "newIndex"],
        "additionalProperties": false
      },
      "validation": {
        "existence_check": "材料の存在確認",
        "index_range": "インデックス範囲の妥当性チェック",
        "order_conflict": "順序変更による影響の評価"
      }
    },
    {
      "name": "pokerinput_proposeTransform",
      "description": "回転・移動変換を提案します（立体の幾何変換）",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "$ref": "#/definitions/object_name",
          "description": "変換の一意な名前"
        },
        "operations": {
          "type": "array",
          "description": "変換操作の配列（順序あり）",
          "minItems": 1,
          "items": {
            "type": "object",
            "properties": {
              "translate": {
                "$ref": "#/definitions/coordinate_string",
                "description": "平行移動ベクトル (x y z形式)"
              },
              "rotate_around_x": {
                "$ref": "#/definitions/rotation_angle",
                "description": "X軸周りの回転角度（度）"
              },
              "rotate_around_y": {
                "$ref": "#/definitions/rotation_angle",
                "description": "Y軸周りの回転角度（度）"
              },
              "rotate_around_z": {
                "$ref": "#/definitions/rotation_angle",
                "description": "Z軸周りの回転角度（度）"
              }
            },
            "note": "各操作は排他的（一つのオブジェクトに一つの操作のみ）"
          }
        }
        },
        "required": ["name", "operations"],
        "additionalProperties": false
      },
      "validation": {
        "name_uniqueness": "変換名の重複チェック",
        "operation_sequence": "操作順序の妥当性チェック",
        "geometric_validity": "幾何学的妥当性の確認"
      }
    },
    {
      "name": "pokerinput_updateTransform",
      "description": "既存変換の操作を更新します（幾何変換の再設定）",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "type": "string",
          "description": "更新する変換名",
          "pattern": "^[a-zA-Z0-9_]+$",
          "maxLength": 50
        },
        "operations": {
          "type": "array",
          "description": "新しい変換操作の配列",
          "minItems": 1,
          "items": {
            "type": "object",
            "properties": {
              "translate": {
                "$ref": "#/definitions/coordinate_string",
                "description": "平行移動ベクトル (x y z形式)"
              },
              "rotate_around_x": {
                "$ref": "#/definitions/rotation_angle",
                "description": "X軸周りの回転角度（度）"
              },
              "rotate_around_y": {
                "$ref": "#/definitions/rotation_angle",
                "description": "Y軸周りの回転角度（度）"
              },
              "rotate_around_z": {
                "$ref": "#/definitions/rotation_angle",
                "description": "Z軸周りの回転角度（度）"
              }
            }
          }
        }
        },
        "required": ["name"],
        "additionalProperties": false
      },
      "validation": {
        "existence_check": "変換の存在確認",
        "operation_validity": "操作パラメータの妥当性チェック",
        "usage_impact": "変換更新の影響範囲確認"
      }
    },
    {
      "name": "pokerinput_deleteTransform",
      "description": "変換を削除します（依存関係チェック付き）",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "type": "string",
          "description": "削除する変換名",
          "pattern": "^[a-zA-Z0-9_]+$",
          "maxLength": 50
        }
        },
        "required": ["name"],
        "additionalProperties": false
      },
      "validation": {
        "existence_check": "変換の存在確認",
        "dependency_check": "依存する立体の確認",
        "safety_validation": "削除の安全性確認"
      },
      "warnings": {
        "dependency_impact": "依存する立体がある場合は削除できません"
      }
    },
    {
      "name": "pokerinput_proposeSource",
      "description": "新しい線源を提案します",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "$ref": "#/definitions/object_name",
          "description": "線源の名前（一意である必要があります）"
        },
        "type": {
          "type": "string",
          "description": "線源タイプ",
          "enum": ["POINT", "SPH", "RCC", "RPP", "BOX"]
        },
        "position": {
          "$ref": "#/definitions/coordinate_string",
          "description": "線源の位置（x y z形式）、typeがPOINTの場合のみ必須"
        },
        "inventory": {
          "type": "array",
          "description": "核種と放射能の組の配列",
          "minItems": 1,
          "items": {
            "type": "object",
            "properties": {
              "nuclide": {
                "type": "string",
                "description": "核種名（元素記号と質量数の連結形式）",
                "pattern": "^[A-Z][a-z]{0,2}[0-9]{1,3}[a-z]?$",
                "examples": ["Cs137", "Co60", "U235", "Tc99m"],
                "note": "末尾のアルファベットは同重体識別子（例：m for metastable）"
              },
              "radioactivity": {
                "$ref": "#/definitions/radioactivity_value",
                "description": "放射能（単位Bq）"
              }
            },
            "required": ["nuclide", "radioactivity"],
            "additionalProperties": false
          }
        },
        "geometry": {
          "type": "object",
          "description": "線源形状パラメータ（typeがPOINT以外の場合に必須）",
          "oneOf": [
            {
              "title": "BOX線源形状",
              "properties": {
                "vertex": {
                  "$ref": "#/definitions/coordinate_string",
                  "description": "頂点座標（x y z形式）"
                },
                "edge_1": {
                  "$ref": "#/definitions/coordinate_string",
                  "description": "エッジ1ベクトル（x y z形式）"
                },
                "edge_2": {
                  "$ref": "#/definitions/coordinate_string",
                  "description": "エッジ2ベクトル（x y z形式）"
                },
                "edge_3": {
                  "$ref": "#/definitions/coordinate_string",
                  "description": "エッジ3ベクトル（x y z形式）"
                },
                "transform": {
                  "$ref": "#/definitions/transform_reference",
                  "description": "適用する変換名"
                }
              },
              "required": ["vertex", "edge_1", "edge_2", "edge_3"],
              "additionalProperties": false
            },
            {
              "title": "RPP線源形状",
              "properties": {
                "min": {
                  "$ref": "#/definitions/coordinate_string",
                  "description": "最小座標（x y z形式）"
                },
                "max": {
                  "$ref": "#/definitions/coordinate_string",
                  "description": "最大座標（x y z形式）"
                },
                "transform": {
                  "$ref": "#/definitions/transform_reference",
                  "description": "適用する変換名"
                }
              },
              "required": ["min", "max"],
              "additionalProperties": false
            },
            {
              "title": "SPH線源形状",
              "properties": {
                "center": {
                  "$ref": "#/definitions/coordinate_string",
                  "description": "中心座標（x y z形式）"
                },
                "radius": {
                  "$ref": "#/definitions/positive_radius",
                  "description": "半径"
                },
                "transform": {
                  "$ref": "#/definitions/transform_reference",
                  "description": "適用する変換名"
                }
              },
              "required": ["center", "radius"],
              "additionalProperties": false
            },
            {
              "title": "RCC線源形状",
              "properties": {
                "bottom_center": {
                  "$ref": "#/definitions/coordinate_string",
                  "description": "底面中心座標（x y z形式）"
                },
                "height_vector": {
                  "$ref": "#/definitions/coordinate_string",
                  "description": "高さベクトル（x y z形式）"
                },
                "radius": {
                  "$ref": "#/definitions/positive_radius",
                  "description": "半径"
                },
                "transform": {
                  "$ref": "#/definitions/transform_reference",
                  "description": "適用する変換名"
                }
              },
              "required": ["bottom_center", "height_vector", "radius"],
              "additionalProperties": false
            }
          ]
        },
        "division": {
          "type": "object",
          "description": "線源の領域分割パラメータ（typeがPOINT以外の場合に必須）",
          "oneOf": [
            {
              "title": "BOX線源分割",
              "properties": {
                "edge_1": {
                  "$ref": "#/definitions/division_axis"
                },
                "edge_2": {
                  "$ref": "#/definitions/division_axis"
                },
                "edge_3": {
                  "$ref": "#/definitions/division_axis"
                }
              },
              "required": ["edge_1", "edge_2", "edge_3"],
              "additionalProperties": false
            },
            {
              "title": "RPP線源分割",
              "properties": {
                "edge_1": {
                  "$ref": "#/definitions/division_axis"
                },
                "edge_2": {
                  "$ref": "#/definitions/division_axis"
                },
                "edge_3": {
                  "$ref": "#/definitions/division_axis"
                }
              },
              "required": ["edge_1", "edge_2", "edge_3"],
              "additionalProperties": false
            },
            {
              "title": "SPH線源分割",
              "properties": {
                "r": {
                  "$ref": "#/definitions/division_axis"
                },
                "theta": {
                  "$ref": "#/definitions/division_axis"
                },
                "phi": {
                  "$ref": "#/definitions/division_axis"
                }
              },
              "required": ["r", "theta", "phi"],
              "additionalProperties": false
            },
            {
              "title": "RCC線源分割",
              "properties": {
                "r": {
                  "$ref": "#/definitions/division_axis"
                },
                "phi": {
                  "$ref": "#/definitions/division_axis"
                },
                "z": {
                  "$ref": "#/definitions/division_axis"
                }
              },
              "required": ["r", "phi", "z"],
              "additionalProperties": false
            }
          ]
        },
        "cutoff_rate": {
          "$ref": "#/definitions/cutoff_rate",
          "description": "放出率カットオフ"
        }
        },
        "required": ["name", "type", "inventory", "cutoff_rate"],
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_updateSource",
      "description": "既存線源のパラメータを更新します",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "type": "string",
          "description": "更新する線源の名前",
          "pattern": "^[a-zA-Z0-9_]+$",
          "maxLength": 50
        },
        "position": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい線源の位置（x y z形式）"
        },
        "inventory": {
          "type": "array",
          "description": "新しい核種と放射能の組の配列",
          "minItems": 1,
          "items": {
            "type": "object",
            "properties": {
              "nuclide": {
                "type": "string",
                "description": "核種名（元素記号と質量数の連結形式）",
                "pattern": "^[A-Z][a-z]{0,2}[0-9]{1,3}[a-z]?$",
                "examples": ["Cs137", "Co60", "U235", "Tc99m"],
                "note": "末尾のアルファベットは同重体識別子（例：m for metastable）"
              },
              "radioactivity": {
                "$ref": "#/definitions/radioactivity_value",
                "description": "放射能（単位Bq）"
              }
            },
            "required": ["nuclide", "radioactivity"],
            "additionalProperties": false
          }
        },
        "geometry": {
          "type": "object",
          "description": "新しい線源形状パラメータ",
          "oneOf": [
            {
              "title": "BOX線源形状",
              "properties": {
                "vertex": {
                  "$ref": "#/definitions/coordinate_string"
                },
                "edge_1": {
                  "$ref": "#/definitions/coordinate_string"
                },
                "edge_2": {
                  "$ref": "#/definitions/coordinate_string"
                },
                "edge_3": {
                  "$ref": "#/definitions/coordinate_string"
                },
                "transform": {
                  "$ref": "#/definitions/transform_reference",
                  "description": "適用する変換名"
                }
              },
              "required": ["vertex", "edge_1", "edge_2", "edge_3"]
            },
            {
              "title": "RPP線源形状",
              "properties": {
                "min": {
                  "$ref": "#/definitions/coordinate_string"
                },
                "max": {
                  "$ref": "#/definitions/coordinate_string"
                },
                "transform": {
                  "$ref": "#/definitions/transform_reference",
                  "description": "適用する変換名"
                }
              },
              "required": ["min", "max"]
            },
            {
              "title": "SPH線源形状",
              "properties": {
                "center": {
                  "$ref": "#/definitions/coordinate_string"
                },
                "radius": {
                  "$ref": "#/definitions/positive_radius"
                },
                "transform": {
                  "$ref": "#/definitions/transform_reference",
                  "description": "適用する変換名"
                }
              },
              "required": ["center", "radius"]
            },
            {
              "title": "RCC線源形状",
              "properties": {
                "bottom_center": {
                  "$ref": "#/definitions/coordinate_string"
                },
                "height_vector": {
                  "$ref": "#/definitions/coordinate_string"
                },
                "radius": {
                  "$ref": "#/definitions/positive_radius"
                },
                "transform": {
                  "$ref": "#/definitions/transform_reference",
                  "description": "適用する変換名"
                }
              },
              "required": ["bottom_center", "height_vector", "radius"]
            }
          ]
        },
        "division": {
          "type": "object",
          "description": "新しい線源の領域分割パラメータ",
          "oneOf": [
            {
              "title": "BOX線源分割",
              "properties": {
                "edge_1": { "$ref": "#/definitions/division_axis" },
                "edge_2": { "$ref": "#/definitions/division_axis" },
                "edge_3": { "$ref": "#/definitions/division_axis" }
              },
              "required": ["edge_1", "edge_2", "edge_3"]
            },
            {
              "title": "RPP線源分割",
              "properties": {
                "edge_1": { "$ref": "#/definitions/division_axis" },
                "edge_2": { "$ref": "#/definitions/division_axis" },
                "edge_3": { "$ref": "#/definitions/division_axis" }
              },
              "required": ["edge_1", "edge_2", "edge_3"]
            },
            {
              "title": "SPH線源分割",
              "properties": {
                "r": { "$ref": "#/definitions/division_axis" },
                "theta": { "$ref": "#/definitions/division_axis" },
                "phi": { "$ref": "#/definitions/division_axis" }
              },
              "required": ["r", "theta", "phi"]
            },
            {
              "title": "RCC線源分割",
              "properties": {
                "r": { "$ref": "#/definitions/division_axis" },
                "phi": { "$ref": "#/definitions/division_axis" },
                "z": { "$ref": "#/definitions/division_axis" }
              },
              "required": ["r", "phi", "z"]
            }
          ]
        },
        "cutoff_rate": {
          "type": "number",
          "description": "新しい放出率カットオフ",
          "minimum": 0.0001,
          "maximum": 1.0
        }
        },
        "required": ["name"],
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_deleteSource",
      "description": "線源を削除します",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "type": "string",
          "description": "削除する線源の名前",
          "pattern": "^[a-zA-Z0-9_]+$",
          "maxLength": 50
        }
        },
        "required": ["name"],
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_proposeDetector",
      "description": "新しい検出器を提案します",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "$ref": "#/definitions/object_name",
          "description": "検出器の名前（一意である必要があります）"
        },
        "origin": {
          "$ref": "#/definitions/coordinate_string",
          "description": "検出器の基準位置（x y z形式）"
        },
        "grid": {
          "type": "array",
          "description": "エッジベクトルと分割数の組の配列（配列の数が検出器の次元を表す）",
          "items": {
            "type": "object",
            "properties": {
              "edge": {
                "$ref": "#/definitions/coordinate_string",
                "description": "エッジベクトル（x y z形式）"
              },
              "number": {
                "$ref": "#/definitions/grid_division",
                "description": "分割数"
              }
            },
            "required": ["edge", "number"]
          }
        },
        "transform": {
          "$ref": "#/definitions/transform_reference",
          "description": "適用する変換名"
        },
        "show_path_trace": {
          "type": "boolean",
          "description": "透過線の経路トレースをサマリーに出力するか",
          "default": false
        }
        },
        "required": ["name", "origin", "show_path_trace"],
        "additionalProperties": false
      },
      "validation": {
        "name_uniqueness": "検出器名の重複チェック",
        "grid_dimension": "グリッド次元の妥当性チェック",
        "coordinate_validity": "座標とベクトルの妥当性確認"
      }
    },
    {
      "name": "pokerinput_updateDetector",
      "description": "既存検出器のパラメータを更新します",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "type": "string",
          "description": "更新する検出器の名前",
          "pattern": "^[a-zA-Z0-9_]+$",
          "maxLength": 50
        },
        "origin": {
          "$ref": "#/definitions/coordinate_string",
          "description": "新しい検出器の基準位置（x y z形式）"
        },
        "grid": {
          "type": "array",
          "description": "新しいエッジベクトルと分割数の組の配列（配列の数が検出器の次元を表す）",
          "items": {
            "type": "object",
            "properties": {
              "edge": {
                "$ref": "#/definitions/coordinate_string",
                "description": "エッジベクトル（x y z形式）"
              },
              "number": {
                "$ref": "#/definitions/grid_division",
                "description": "分割数"
              }
            },
            "required": ["edge", "number"]
          }
        },
        "transform": {
          "$ref": "#/definitions/transform_reference",
          "description": "適用する変換名"
        },
        "show_path_trace": {
          "type": "boolean",
          "description": "透過線の経路トレースをサマリーに出力するか"
        }
        },
        "required": ["name"],
        "additionalProperties": false
      },
      "validation": {
        "existence_check": "検出器の存在確認",
        "parameter_validity": "更新パラメータの妥当性チェック",
        "grid_consistency": "グリッド設定の一貫性確認"
      }
    },
    {
      "name": "pokerinput_deleteDetector",
      "description": "検出器を削除します",
      "parameters": {
        "type": "object",
        "properties": {
        "name": {
          "type": "string",
          "description": "削除する検出器の名前",
          "pattern": "^[a-zA-Z0-9_]+$",
          "maxLength": 50
        }
        },
        "required": ["name"],
        "additionalProperties": false
      },
      "validation": {
        "existence_check": "検出器の存在確認",
        "safety_validation": "削除の安全性確認"
      }
    },
    {
      "name": "pokerinput_applyChanges",
      "description": "全ての保留中の変更を実際のYAMLファイルに適用します。自動的にバックアップが作成されます。",
      "parameters": {
        "type": "object",
        "properties": {
        "force": {
          "type": "boolean",
          "description": "強制適用フラグ（警告を無視）",
          "default": false
        },
        "backup_comment": {
          "$ref": "#/definitions/comment_length",
          "description": "バックアップのコメント"
        }
        },
        "additionalProperties": false
      }
    },
    {
      "name": "pokerinput_proposeUnit",
      "description": "単位設定セクションを提案します（YAMLファイルに未存在の場合のみ）",
      "parameters": {
        "type": "object",
        "properties": {
        "length": {
          "$ref": "#/definitions/supported_length_unit",
          "description": "長さの単位",
          "default": "cm"
        },
        "angle": {
          "$ref": "#/definitions/supported_angle_unit",
          "description": "角度の単位",
          "default": "radian"
        },
        "density": {
          "$ref": "#/definitions/supported_density_unit",
          "description": "密度の単位",
          "default": "g/cm3"
        },
        "radioactivity": {
          "$ref": "#/definitions/supported_radioactivity_unit",
          "description": "放射能の単位",
          "default": "Bq"
        }
        },
        "required": ["length", "angle", "density", "radioactivity"],
        "additionalProperties": false
      },
      "validation": {
        "existence_check": "unit セクションの非存在チェック",
        "completeness_check": "4つのキー存在確認",
        "unit_value_validation": "単位選択肢の妥当性チェック"
      }
    },
    {
      "name": "pokerinput_getUnit",
      "description": "現在の単位設定を取得します（4つのキーすべてを返却）",
      "parameters": {
        "type": "object",
        "additionalProperties": false
      },
      "validation": {
        "completeness_check": "4つのキー存在確認",
        "auto_repair": "不完全な場合はデフォルト値で補完"
      }
    },
    {
      "name": "pokerinput_updateUnit",
      "description": "既存単位設定を更新します（部分更新だが4つのキーは常に維持）",
      "parameters": {
        "type": "object",
        "properties": {
        "length": {
          "$ref": "#/definitions/supported_length_unit",
          "description": "新しい長さの単位"
        },
        "angle": {
          "$ref": "#/definitions/supported_angle_unit",
          "description": "新しい角度の単位"
        },
        "density": {
          "$ref": "#/definitions/supported_density_unit",
          "description": "新しい密度の単位"
        },
        "radioactivity": {
          "$ref": "#/definitions/supported_radioactivity_unit",
          "description": "新しい放射能の単位"
        }
        },
        "minProperties": 1,
        "additionalProperties": false
      },
      "validation": {
        "existence_check": "unit セクションの存在チェック",
        "completeness_maintained": "4つのキー完全性維持",
        "unit_value_validation": "単位選択肢の妥当性チェック"
      }
    },
    {
      "name": "pokerinput_executeCalculation",
      "description": "作成したYAMLファイルを使用してpoker_cuiで放射線遮蔽計算を実行します",
      "parameters": {
        "type": "object",
        "properties": {
          "yaml_file": {
            "type": "string",
            "description": "計算に使用するYAMLファイル名（拡張子.yamlを含む）",
            "pattern": "^[a-zA-Z0-9_\\-\\.]+\\.(yaml|yml)$",
            "examples": ["shielding_model.yaml", "hospital_design.yaml", "reactor_shield.yaml"]
          },
          "summary_options": {
            "type": "object",
            "description": "サマリー出力オプション（注意: show_source_dataとshow_total_doseの少なくとも一方は必須です）",
            "properties": {
              "show_parameters": {
                "type": "boolean",
                "description": "入力パラメータをサマリーに表示（-pオプション）",
                "default": false
              },
              "show_source_data": {
                "type": "boolean",
                "description": "各線源による計算データ及び線量をサマリーに表示（-sオプション）",
                "default": true
              },
              "show_total_dose": {
                "type": "boolean", 
                "description": "各検出器に対する全線源からの総和線量をサマリーに表示（-tオプション）",
                "default": true
              }
            },
            "additionalProperties": false
          },
          "output_files": {
            "type": "object",
            "description": "出力ファイル指定（全てYAML形式）",
            "properties": {
              "summary_file": {
                "type": "string",
                "description": "出力サマリーファイル名（-oオプション、YAML形式）",
                "pattern": "^[a-zA-Z0-9_\\-\\.]+\\.(yaml|yml)$",
                "examples": ["calculation_summary.yaml", "shield_analysis.yml", "result_summary.yaml"]
              },
              "dose_file": {
                "type": "string", 
                "description": "線量ファイル名（-dオプション、YAML形式）",
                "pattern": "^[a-zA-Z0-9_\\-\\.]+\\.(yaml|yml)$",
                "examples": ["dose_rates.yaml", "detector_doses.yml", "dose_distribution.yaml"]
              }
            },
            "additionalProperties": false
          }
        },
        "required": ["yaml_file"],
        "additionalProperties": false
      },
      "validation": {
        "yaml_file_existence": "YAMLファイルの存在確認",
        "yaml_syntax_check": "YAML構文の妥当性確認", 
        "completeness_check": "必要セクション（body, zone, source等）の存在確認",
        "poker_cui_availability": "poker_cuiコマンドの利用可能性確認",
        "summary_options_validation": "show_source_dataまたはshow_total_doseの少なくとも一方が必須。両方がfalseの場合はエラー、またはshow_total_doseを強制的にtrueに設定",
        "output_directory_check": "出力ディレクトリの作成可能性確認"
      }
    }
  ],
  "definitions": {
    "coordinate_string": {
      "type": "string",
      "pattern": "^-?\\d+(\\.\\d+)?\\s+-?\\d+(\\.\\d+)?\\s+-?\\d+(\\.\\d+)?$",
      "description": "x y z形式の座標文字列"
    },
    "positive_radius": {
      "type": "number",
      "minimum": 0.001,
      "maximum": 10000,
      "description": "正の半径値 (cm)"
    },
    "density_value": {
      "type": "number",
      "minimum": 0.001,
      "maximum": 30.0,
      "description": "密度値 (g/cm³)"
    },
    "radioactivity_value": {
      "type": "number",
      "minimum": 0.001,
      "maximum": 1e15,
      "description": "放射能値 (Bq)"
    },
    "object_name": {
      "type": "string",
      "pattern": "^[a-zA-Z0-9_]+$",
      "maxLength": 50,
      "description": "オブジェクト名（英数字とアンダースコアのみ）"
    },
    "rotation_angle": {
      "type": "number",
      "minimum": -360,
      "maximum": 360,
      "description": "回転角度（度）"
    },
    "cutoff_rate": {
      "type": "number",
      "minimum": 0.0001,
      "maximum": 1.0,
      "default": 0.0001,
      "description": "カットオフ率"
    },
    "buildup_index": {
      "type": "integer",
      "minimum": 0,
      "maximum": 100,
      "description": "ビルドアップ係数インデックス"
    },
    "grid_division": {
      "type": "integer",
      "minimum": 2,
      "maximum": 1000,
      "description": "グリッド分割数"
    },
    "comment_length": {
      "type": "string",
      "maxLength": 200,
      "description": "コメント文字列"
    },
    "division_axis": {
      "type": "object",
      "description": "分割軸の設定",
      "properties": {
        "type": {
          "type": "string",
          "description": "分割タイプ",
          "enum": ["UNIFORM", "GAUSS_FIRST", "GAUSS_LAST", "GAUSS_BOTH", "GAUSS_CENTER"],
          "default": "UNIFORM"
        },
        "number": {
          "$ref": "#/definitions/grid_division",
          "description": "分割数"
        },
        "min": {
          "type": "number",
          "description": "分割開始位置（0.0～1.0）",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 0.0
        },
        "max": {
          "type": "number",
          "description": "分割終了位置（0.0～1.0）",
          "minimum": 0.0,
          "maximum": 1.0,
          "default": 1.0
        }
      },
      "required": ["type", "number"],
      "additionalProperties": false
    },
    "supported_material": {
      "type": "string",
      "enum": ["Carbon", "Concrete", "Iron", "Lead", "Aluminum", "Copper", "Tungsten", "Air", "Water", "PyrexGlass", "AcrylicResin", "Polyethylene", "Soil", "VOID"],
      "description": "サポートされる材料名"
    },
    "supported_length_unit": {
      "type": "string",
      "enum": ["m", "cm", "mm"],
      "description": "サポートされる長さ単位"
    },
    "supported_angle_unit": {
      "type": "string",
      "enum": ["radian", "degree"],
      "description": "サポートされる角度単位"
    },
    "supported_density_unit": {
      "type": "string",
      "enum": ["g/cm3"],
      "description": "サポートされる密度単位"
    },
    "supported_radioactivity_unit": {
      "type": "string",
      "enum": ["Bq"],
      "description": "サポートされる放射能単位"
    },
    "transform_reference": {
      "type": "string",
      "description": "変換参照名（YAMLデータファイルのtransformセクションで既に定義されたnameからのみ選択可能、英数字とアンダースコアのみ）",
      "pattern": "^[a-zA-Z0-9_]+$",
      "maxLength": 50,
      "constraint": "must_exist_in_yaml_transform_section",
      "validation": {
        "existence_check": "YAMLファイルのtransform配列内でのname検索",
        "error_on_missing": "指定された変換名が存在しない場合は-32017エラー"
      }
    }
  },
  "validation_enhanced": {
    "atmosphere_zone_constraints": {
      "reserved_name": "ATMOSPHERE",
      "uniqueness": "必須かつ唯一",
      "role": "complement_zone",
      "physical_meaning": "他のゾーンで定義されていない全領域を表現",
      "naming_restrictions": {
        "forbidden_as_body_name": true,
        "reserved_keyword": true,
        "case_sensitive": true
      },
      "zone_section_requirements": {
        "mandatory_presence": true,
        "quantity": "exactly_one",
        "deletion": "prohibited",
        "material_assignment": "required"
      },
      "material_constraints": {
        "VOID": {
          "density_specification": "prohibited",
          "reason": "真空は密度を持たないため記載不要"
        },
        "non_void_materials": {
          "density_specification": "mandatory",
          "reason": "すべての物理材料は密度値が必須"
        }
      }
    },
    "material_constraints": {
      "supported_materials": ["Carbon", "Concrete", "Iron", "Lead", "Aluminum", "Copper", "Tungsten", "Air", "Water", "PyrexGlass", "AcrylicResin", "Polyethylene", "Soil", "VOID"],
      "density_validation": {
        "VOID": "density パラメータ指定禁止",
        "other_materials": "density パラメータ必須"
      }
    },
    "nuclide_constraints": {
      "format": "element_symbol_mass_number_concatenated",
      "pattern": "^[A-Z][a-z]{0,2}[0-9]{1,3}[a-z]?$",
      "examples": ["Cs137", "Co60", "U235", "Ra226", "Am241", "Tc99m"],
      "forbidden": ["Cs-137", "Co-60", "U-235"],
      "migration_rule": "remove_hyphens_between_element_and_mass",
      "metastable_suffix": "single_lowercase_letter_allowed"
    },
    "buildup_factor_constraints": {
      "supported_corrections": ["use_slant_correction", "use_finite_medium_correction"]
    },
    "detector_constraints": {
      "supported_types": ["POINT", "GRID_1D", "GRID_2D", "GRID_3D"]
    },
    "unit_constraints": {
      "mandatory_keys": ["length", "angle", "density", "radioactivity"],
      "supported_values": {
        "length": ["m", "cm", "mm"],
        "angle": ["radian", "degree"],
        "density": ["g/cm3"],
        "radioactivity": ["Bq"]
      },
      "uniqueness": "single_unit_section_only",
      "completeness": "four_keys_always_required"
    },
    "auto_repair_constraints": {
      "repair_triggers": ["missing_unit_section", "incomplete_keys", "invalid_values"],
      "default_fallback": {
        "length": "cm",
        "angle": "radian",
        "density": "g/cm3",
        "radioactivity": "Bq"
      },
      "repair_logging": "comprehensive"
    },
    "body_type_constraints": {
      "SPH": {
        "required_parameters": ["name", "type", "center", "radius"]
      },
      "RCC": {
        "required_parameters": ["name", "type", "bottom_center", "height_vector", "radius"]
      },
      "RPP": {
        "required_parameters": ["name", "type", "min", "max"]
      },
      "BOX": {
        "required_parameters": ["name", "type", "vertex", "edge_1", "edge_2", "edge_3"]
      },
      "TOR": {
        "required_parameters": ["name", "type", "center", "normal", "major_radius", "minor_radius_horizontal", "minor_radius_vertical"]
      },
      "ELL": {
        "required_parameters": ["name", "type", "center", "radius_vector_1", "radius_vector_2", "radius_vector_3"]
      },
      "TRC": {
        "required_parameters": ["name", "type", "bottom_center", "height_vector", "bottom_radius", "top_radius"]
      },
      "REC": {
        "required_parameters": ["name", "type", "bottom_center", "height_vector", "radius_vector_1", "radius_vector_2"]
      },
      "WED": {
        "required_parameters": ["name", "type", "vertex", "width_vector", "height_vector", "depth_vector"]
      },
      "CMB": {
        "required_parameters": ["name", "type", "expression"]
      }
    },
    "cmb_expression_constraints": {
      "body_reference_validation": {
        "requirement": "all_referenced_bodies_must_exist",
        "check_timing": "before_cmb_creation",
        "error_handling": "detailed_error_with_missing_body_list",
        "circular_reference_detection": true,
        "max_reference_depth": 10
      },
      "expression_parsing": {
        "supported_operators": ["+", "-", "&"],
        "forbidden_operators": ["*", "/", "^", "|"],
        "bracket_validation": "balanced_parentheses_required",
        "body_name_extraction": "regex_based_parsing",
        "operator_precedence": "left_to_right_with_parentheses"
      },
      "physical_validation": {
        "void_material_warning": "VOIDと物理材料の組み合わせ時に警告",
        "geometric_feasibility": "重複しない立体のINTERSECTION警告",
        "result_volume_check": "演算結果が空集合の可能性チェック"
      }
    }
  },
  "error_handling": {
    "json_rpc_compliant": true,
    "custom_error_codes": {
      "-32001": "Body not found",
      "-32002": "Zone not found", 
      "-32003": "Duplicate name",
      "-32004": "Invalid body type",
      "-32005": "Dependency exists",
      "-32006": "File access error",
      "-32007": "Validation error",
      "-32008": "Backup error",
      "-32009": "Unit already exists",
      "-32010": "Unit not found",
      "-32011": "Unit incomplete",
      "-32012": "Unit key missing",
      "-32013": "Unit invalid value",
      "-32014": "Unit delete forbidden",
      "-32015": "Unit repair failed",
      "-32016": "Unit validation failed",
      "-32017": "Transform not found",
      "-32018": "Invalid transform reference",
      "-32019": "Invalid name format - hyphens not allowed",
      "-32020": "Name contains forbidden characters",
      "-32021": "Invalid nuclide format - use concatenated format (e.g., Cs137)",
      "-32022": "Nuclide contains forbidden hyphen",
      "-32023": "ATMOSPHERE is reserved - cannot be used as body name",
      "-32024": "ATMOSPHERE zone is mandatory and cannot be deleted",
      "-32025": "Multiple ATMOSPHERE zones not allowed",
      "-32026": "ATMOSPHERE zone must exist in zone section",
      "-32027": "ATMOSPHERE zone material assignment required",
      "-32028": "Density cannot be specified for VOID material",
      "-32029": "Density must be specified for non-VOID materials",
      "-32030": "Missing required density parameter for physical material",
      "-32031": "Referenced body not found in CMB expression",
      "-32032": "Circular reference detected in CMB expression",
      "-32033": "Invalid operator in CMB expression",
      "-32034": "Unbalanced parentheses in CMB expression",
      "-32035": "Empty CMB expression",
      "-32036": "CMB expression too complex (max depth exceeded)",
      "-32040": "YAML file not found",
      "-32041": "Invalid YAML syntax", 
      "-32042": "poker_cui command not available",
      "-32043": "Calculation execution failed",
      "-32044": "Calculation timeout",
      "-32045": "Insufficient system resources",
      "-32046": "Output directory access denied",
      "-32047": "Invalid calculation parameters",
      "-32048": "Calculation cancelled by user",
      "-32049": "Results parsing failed",
      "-32054": "Unsupported material with suggestion"
    }
  },
  "data_files": {
    "input": "tasks/pokerinputs.yaml",
    "pending_changes": "tasks/pending_changes.json",
    "backup_directory": "backups/"
  },
  "backup_features": {
    "automatic_backup": true,
    "timestamp_format": "ISO_8601",
    "retention_policy": "最新10個のバックアップを保持",
    "cleanup_automatic": true
  },
  "production_features": {
    "real_yaml_updates": true,
    "transaction_safety": true,
    "graceful_shutdown": true,
    "memory_management": "optimized",
    "performance": "production_ready"
  },
  "material_alternatives": {
    "description": "一般的な材料名からサポート材料への代替マッピング（放射線遮蔽計算用）",
    "STEEL": { "substitute": "Iron", "note": "一般的な構造用鋼はIronで代替" },
    "STAINLESS_STEEL": { "substitute": "Iron", "note": "ステンレス鋼もIronで代替可能" },
    "BRASS": { "substitute": "Copper", "note": "真鍮はCopperで代替" },
    "BRONZE": { "substitute": "Copper", "note": "青銅はCopperで代替" },
    "GLASS": { "substitute": "PyrexGlass", "note": "一般ガラスはPyrexGlassで代替" },
    "PLASTIC": { "substitute": "AcrylicResin", "note": "一般プラスチックはAcrylicResinで代替" },
    "EARTH": { "substitute": "Soil", "note": "土壌はSoilで代替" },
    "VOID_SPACE": { "substitute": "VOID", "note": "真空空間はVOIDで代替" },
    "ATMOSPHERE": { "substitute": "Air", "note": "大気はAirで代替" }
  },
  "material_constraints": {
    "description": "材料制約と物理的特性情報（放射線遮蔽研究用）",
    "strict_validation": true,
    "allow_alternatives": true,
    "error_with_suggestions": true,
    "supported_materials": {
      "Carbon": { 
        "typical_use": "グラファイト、炭素繊維構造材",
        "shielding_properties": "軽量遮蔽材"
      },
      "Concrete": { 
        "typical_use": "建築構造、放射線遮蔽壁",
        "shielding_properties": "汎用遮蔽材、経済的"
      },
      "Iron": { 
        "typical_use": "鉄鋼構造、STEEL代替",
        "shielding_properties": "中重量遮蔽材、構造材兼用"
      },
      "Lead": { 
        "typical_use": "高効率遮蔽材",
        "shielding_properties": "高密度γ線遮蔽材"
      },
      "Aluminum": { 
        "typical_use": "軽量構造材",
        "shielding_properties": "軽量遮蔽材、耐食性"
      },
      "Copper": { 
        "typical_use": "BRASS/BRONZE代替",
        "shielding_properties": "中重量遮蔽材、導電性"
      },
      "Tungsten": { 
        "typical_use": "超高密度遮蔽材",
        "shielding_properties": "最高密度遮蔽材"
      },
      "Air": { 
        "typical_use": "大気、ATMOSPHERE代替",
        "shielding_properties": "透明媒体"
      },
      "Water": { 
        "typical_use": "中性子減速材、冷却材",
        "shielding_properties": "中性子遮蔽材"
      },
      "PyrexGlass": { 
        "typical_use": "GLASS代替、耐熱ガラス",
        "shielding_properties": "透明遮蔽材"
      },
      "AcrylicResin": { 
        "typical_use": "PLASTIC代替、透明樹脂",
        "shielding_properties": "軽量透明遮蔽材"
      },
      "Polyethylene": { 
        "typical_use": "中性子遮蔽樹脂",
        "shielding_properties": "中性子減速・遮蔽材"
      },
      "Soil": { 
        "typical_use": "EARTH代替、土壌遮蔽",
        "shielding_properties": "天然遮蔽材"
      },
      "VOID": { 
        "density_specification": "prohibited",
        "typical_use": "真空、VOID_SPACE代替",
        "shielding_properties": "非遮蔽領域"
      }
    }
  },
  "error_handling_enhancement": {
    "description": "材料制約エラーの改善されたハンドリング",
    "unsupported_material_error": {
      "code": -32054,
      "message_template": "Unsupported material '{material}'. Did you mean '{suggested_substitute}'? Supported materials: {supported_list}",
      "suggestion_logic": "fuzzy_match_with_alternatives"
    },
    "material_suggestion_examples": {
      "STEEL": "Use 'Iron' instead of 'STEEL' for structural steel approximation",
      "STAINLESS": "Use 'Iron' instead of 'STAINLESS' for stainless steel approximation", 
      "BRASS": "Use 'Copper' instead of 'BRASS' for brass alloy approximation",
      "GLASS": "Use 'PyrexGlass' instead of 'GLASS' for glass material approximation",
      "PLASTIC": "Use 'AcrylicResin' instead of 'PLASTIC' for plastic material approximation",
      "EARTH": "Use 'Soil' instead of 'EARTH' for earth material approximation"
    }
  }
}