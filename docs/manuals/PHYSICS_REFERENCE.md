# 📋 PHYSICS_REFERENCE.md - 放射線遮蔽物理リファレンス

**⚛️ 対象**: 放射線遮蔽計算の物理的背景を理解したい研究者  
**📚 マニュアル階層**: エッセンシャル層  
**🔧 対応システム**: Poker MCP Server v1.2.5 MCP Edition  
**🔧 バージョン**: 1.2.5 MCP Edition  
**📅 最終更新**: 2025年1月24日

---

## 📖 本書の位置づけ

この文書は**エッセンシャル層**の物理リファレンスです。

### 🎯 対象読者
- **放射線遮蔽研究者**: 計算の物理的背景を深く理解したい
- **原子力・医療物理学研究者**: 遮蔽理論の実装を確認したい
- **設計エンジニア**: 計算パラメータの物理的意味を理解したい
- **品質保証担当者**: 結果の妥当性を物理的に検証したい

### 📋 読み方ガイド
- **基本操作習得**: [ESSENTIAL_GUIDE.md](ESSENTIAL_GUIDE.md)と併用
- **日常参照**: [QUICK_REFERENCE.md](QUICK_REFERENCE.md)で操作確認
- **実践応用**: [RESEARCH_WORKFLOWS.md](RESEARCH_WORKFLOWS.md)で具体例

---

## 🛠️ 計算環境設定の物理的考慮事項

### POKER_INSTALL_PATH環境変数の物理的重要性

**核種データベースの役割**:
環境変数POKER_INSTALL_PATHは、物理計算に必要な核種データベース（ICRP-07.NDX）への参照を提供します。

```
核種データベース（ICRP-07.NDX）の物理的内容:
- 放射性崩壊定数 λ [s⁻¹]
- γ線放出確率 Y [/decay]  
- γ線エネルギースペクトル E_γ [keV]
- 子孫核種への分岐比
- 平衡時の放射能比
```

**物理的正確性への影響**:
- データベース未設定 → 核種物性の欠如 → 線源強度計算エラー
- 子孫核種の無視 → 実際より過小評価
- エネルギースペクトル欠如 → 遮蔽効果の誤評価

**設定方法（物理計算品質確保のため）**:
```bash
# Windows環境での設定
setx POKER_INSTALL_PATH "C:\Program Files\POKER"

# Linux環境での設定  
export POKER_INSTALL_PATH="/usr/local/share/poker"
```

---

## ⚛️ 放射線遮蔽理論の基礎

### 🌟 **遮蔽計算の物理的意味**

**遮蔽とは何か？**
放射線遮蔽とは、**放射線と物質の相互作用により放射線強度を減衰させる物理現象**です。

```
入射放射線 → [遮蔽材] → 透過放射線
    I₀              I
```

**基本減衰法則**:
```
I = I₀ × e^(-μt) × B(μt, E)
```

- **I₀**: 入射強度
- **I**: 透過強度  
- **μ**: 線減衰係数(cm⁻¹)
- **t**: 遮蔽厚さ(cm)
- **B(μt, E)**: ビルドアップ係数

### 🔬 **放射線と物質の相互作用機構**

#### **ガンマ線の相互作用**

**1. 光電効果(Photoelectric Effect)**
```
γ + 原子 → 電子 + イオン
```
- **支配領域**: 低エネルギー(<0.5 MeV)
- **断面積 ∝ Z⁵/E^3.5**: 原子番号の5乗に比例
- **完全吸収**: ガンマ線が完全に消失

**2. コンプトン散乱(Compton Scattering)**
```
γ + e⁻ → γ' + e⁻
```
- **支配領域**: 中間エネルギー(0.5-10 MeV)
- **断面積 ∝ Z**: 原子番号に比例
- **部分的減衰**: エネルギー転移と方向変化

**3. 電子対生成(Pair Production)**
```
γ → e⁺ + e⁻ (E > 1.022 MeV)
```
- **支配領域**: 高エネルギー(>10 MeV)
- **断面積 ∝ Z²**: 原子番号の2乗に比例
- **閾値**: 1.022 MeV（電子の静止質量エネルギーの2倍）

#### **中性子の相互作用**

**1. 弾性散乱(Elastic Scattering)**
```
n + 核 → n + 核
```
- **減速**: 中性子エネルギーの減少
- **軽核が効果的**: 水素、ベリリウム、炭素

**2. 非弾性散乱 (Inelastic Scattering)**
```
n + 核 → n + 核* → n + 核 + γ
```
- **高エネルギー中性子**: >1 MeV
- **ガンマ線生成**: 二次ガンマ線の考慮が必要

**3. 吸収反応 (Absorption)**
```
n + 核 → 生成物 + エネルギー
```
- **(n,γ)反応**: 熱中性子の主要反応
- **(n,α), (n,p)反応**: 軽核での反応
- **核分裂**: 重核での反応

---

## 📐 ビルドアップ係数の物理

### **ビルドアップ係数とは**
単純な指数減衰則では、**散乱線の寄与を考慮できません**。ビルドアップ係数B(μt, E)は、散乱線を含む総線量を補正する係数です。

```
B(μt, E) = 透過線量（散乱含む）/ 透過線量（散乱なし）
```

### **BuildupFactor操作の4メソッドの物理的意味**

#### **1. proposeBuildupFactor**
新しい材料のビルドアップ係数計算を設定します。

物理パラメータ：
- **use_slant_correction**: 斜め入射時の経路長増加を補正
- **use_finite_medium_correction**: 有限媒体での境界効果を補正

#### **2. updateBuildupFactor**
既存材料の計算パラメータを変更します。

#### **3. deleteBuildupFactor**
材料のビルドアップ係数を計算から除外します。

#### **4. changeOrderBuildupFactor**
**計算順序の物理的意味**：
- 多層遮蔽での層順序効果
- エネルギー依存性の考慮順序
- 計算収束性の改善

---

## 📊 実装されている立体形状の物理的意味

### 🔷 **10種類立体タイプの完全対応**

#### **1. SPH（球体）- 点線源遮蔽の基本**

**物理的意味**:
- **等方性**: すべての方向に均等な遮蔽効果
- **距離減衰**: 1/r²法則が明確に適用
- **対称性**: 解析的解が存在する理想形状

**パラメータ**:
```yaml
center: "x y z"    # 球心座標 [長さ単位]
radius: float      # 半径 [長さ単位], 範囲: 0.001-10000
```

**適用例**:
- 点線源周りの球対称遮蔽
- 原子炉圧力容器の概略モデル
- 医療用密封線源の遮蔽計算

#### **2. RCC（直円柱）- 軸対称構造**

**物理的意味**:
- **軸対称性**: 円柱軸周りの対称な遮蔽効果
- **端面効果**: 円柱端面での散乱・漏えいの考慮
- **実用性**: 多くの実構造物との対応

**パラメータ**:
```yaml
bottom_center: "x y z"  # 底面中心 [長さ単位]
height_vector: "x y z"  # 高さベクトル [長さ単位]
radius: float           # 半径 [長さ単位], 範囲: 0.001-10000
```

**適用例**:
- 燃料棒集合体
- 廃棄物保管容器
- 冷却配管の遮蔽

#### **3. RPP（軸平行直方体）- 建築構造の基本**

**物理的意味**:
- **座標軸平行**: 計算効率が高い
- **建築構造**: 実際の建物形状との直接対応
- **境界条件**: 明確な境界面

**パラメータ**:
```yaml
min: "x y z"      # 最小座標 [長さ単位]
max: "x y z"      # 最大座標 [長さ単位]
```

**適用例**:
- 遮蔽室・遮蔽壁
- 建物構造の簡略モデル
- 直方体容器

#### **4. BOX（任意直方体）- 複雑配置対応**

**物理的意味**:
- **任意方向**: 傾斜・回転した構造物
- **3ベクトル定義**: 柔軟な形状定義
- **実測対応**: 実際の傾斜構造との対応

**パラメータ**:
```yaml
vertex: "x y z"    # 基準頂点 [長さ単位]
edge_1: "x y z"    # エッジベクトル1 [長さ単位]
edge_2: "x y z"    # エッジベクトル2 [長さ単位]  
edge_3: "x y z"    # エッジベクトル3 [長さ単位]
```

**適用例**:
- 傾斜遮蔽壁
- 任意角度の構造物
- 複雑な設備配置

#### **5. CMB（組み合わせ）- 複合形状**

**物理的意味**:
- **集合演算**: 複数立体の論理演算
- **複雑形状**: 単純立体では表現困難な形状
- **穴あき構造**: 貫通部・空洞の表現

**パラメータ**:
```yaml
expression: "body1 + body2 - body3"  # 集合演算式
# + : 和集合（UNION）
# - : 差集合（DIFFERENCE）  
# & : 積集合（INTERSECTION）
```

**適用例**:
- 貫通配管のある遮蔽壁
- 複雑な機器形状
- 多重遮蔽構造

#### **6. TOR（トーラス）- 環状構造**

**物理的意味**:
- **環状対称**: 環状方向の均一性
- **曲率効果**: 曲面での散乱特性
- **トポロジー**: ドーナツ型の閉曲面

**パラメータ**:
```yaml
center: "x y z"                    # 中心座標 [長さ単位]
normal: "x y z"                    # 軸方向単位ベクトル
major_radius: float                # 主半径 [長さ単位]
minor_radius_horizontal: float     # 水平副半径 [長さ単位]
minor_radius_vertical: float       # 垂直副半径 [長さ単位]
```

**適用例**:
- トカマク型核融合炉
- 環状配管
- 曲管部の遮蔽

#### **7. ELL（楕円体）- 非球対称構造**

**物理的意味**:
- **3軸不等**: 異方性のある遮蔽効果
- **滑らかな曲面**: 応力集中の回避
- **変形球**: 実際の容器形状への対応

**パラメータ**:
```yaml
center: "x y z"          # 中心座標 [長さ単位]
radius_vector_1: "x y z" # 半径ベクトル1 [長さ単位]
radius_vector_2: "x y z" # 半径ベクトル2 [長さ単位]
radius_vector_3: "x y z" # 半径ベクトル3 [長さ単位]
```

**適用例**:
- 加圧容器の端部
- 楕円形タンク
- 生体遮蔽の近似

#### **8. REC（楕円柱）- 非円形断面柱**

**物理的意味**:
- **楕円断面**: 非円形の柱状構造
- **方向性**: 断面の長軸・短軸効果
- **実構造対応**: 変形した配管等

**パラメータ**:
```yaml
bottom_center: "x y z"   # 底面中心 [長さ単位]
height_vector: "x y z"   # 高さベクトル [長さ単位]
radius_vector_1: "x y z" # 半径ベクトル1 [長さ単位]
radius_vector_2: "x y z" # 半径ベクトル2 [長さ単位]
```

**適用例**:
- 楕円形ダクト
- 変形容器
- 特殊形状配管

#### **9. TRC（円錐台）- テーパー構造**

**物理的意味**:
- **テーパー形状**: 連続的な断面変化
- **ストリーミング**: 狭小部での線束集中
- **実用形状**: ノズル・ホッパー形状

**パラメータ**:
```yaml
bottom_center: "x y z"  # 底面中心 [長さ単位]
height_vector: "x y z"  # 高さベクトル [長さ単位]
bottom_radius: float    # 底面半径 [長さ単位]
top_radius: float       # 上面半径 [長さ単位]
```

**適用例**:
- コリメータ
- ビームダクト
- ホッパー・漏斗形状

#### **10. WED（楔形）- くさび構造**

**物理的意味**:
- **非対称形状**: 方向による遮蔽厚さの変化
- **斜面効果**: 斜め入射での経路長変化
- **隙間充填**: 複雑形状の隙間処理

**パラメータ**:
```yaml
vertex: "x y z"        # 頂点座標 [長さ単位]
width_vector: "x y z"  # 幅ベクトル [長さ単位]
height_vector: "x y z" # 高さベクトル [長さ単位]
depth_vector: "x y z"  # 奥行きベクトル [長さ単位]
```

**適用例**:
- 斜め遮蔽板
- 隙間の充填材
- 段差部の遮蔽

---

## 🔢 単位系の物理的整合性（5メソッド）

### **Unit操作の物理的意味**

#### **1. proposeUnit - 単位系定義**
4つの基本物理量の単位を定義：
- **length**: 長さの単位（m, cm, mm）
- **angle**: 角度の単位（radian, degree）
- **density**: 密度の単位（g/cm³）
- **radioactivity**: 放射能の単位（Bq）

#### **2. getUnit - 現在の単位系取得**
計算に使用中の単位系を確認

#### **3. updateUnit - 単位系変更**
既存データの単位変換を伴う単位系変更

#### **4. validateUnitIntegrity - 整合性検証**
**物理的整合性チェック**:
- 長さ単位と密度単位の整合性
- 角度単位の一貫性
- 放射能単位の適切性

#### **5. analyzeUnitConversion - 変換係数分析**
**単位変換の物理**:
```
変換例：
長さ: 1 m = 100 cm = 1000 mm
角度: 1 radian = 57.2958 degree
線量率: μSv/h = 10⁻⁶ Sv/h
```

---

## 🧮 poker_cui計算の物理プロセス

### **計算アルゴリズムの概要**

#### **1. レイトレーシング法**
```
線源 → 遮蔽材通過 → 検出器
```
- 線源から検出器への直線経路追跡
- 通過物質の同定と経路長計算
- 減衰計算の累積

#### **2. カットオフレートの物理的意味**
```yaml
cutoff_rate: 0.0001  # デフォルト値
```
- **意味**: 元の強度の0.01%以下は計算打ち切り
- **効果**: 計算効率向上と精度のバランス
- **選択基準**: 必要精度と計算時間のトレードオフ

### **サマリーファイルの物理的解釈**

#### **入力パラメータセクション**
```yaml
入力パラメータ:
  bodies: [...]     # 幾何形状定義
  zones: [...]      # 材料配置
  sources: [...]    # 放射線源
  detectors: [...]  # 評価点
```
- 計算条件の完全な記録
- 再現性の保証

#### **intermediateセクション**
```yaml
intermediate:
  source_1:
    detector_1:
      path_length: 50.0  # 経路長 [cm]
      materials: ["CONCRETE"]  # 通過材料
      attenuation: 0.123  # 減衰係数
```
- 物理的な透過経路の詳細
- 減衰計算の中間値

#### **resultセクション**
```yaml
result:
  source_1:
    detector_1:
      dose: 1.23e-5  # 線量率
      buildup: 2.5   # ビルドアップ係数
```
- 個別線源からの寄与
- 散乱線を含む実効線量

#### **result_totalセクション**
```yaml
result_total:
  detector_1:
    total_dose: 2.46e-5  # 総線量率 [μSv/h]
    dominant_source: "source_1"  # 主要線源
```
- 全線源からの総和
- 支配的な線源の特定

---

## 🧪 材料データベースの詳細

### **13種類の標準材料物性値**

| 材料名 | 密度範囲 (g/cm³) | 推奨密度 | 原子番号 (実効) | 主要用途 |
|--------|------------------|----------|-----------------|----------|
| Carbon | 1.5-2.3 | 2.0 | 6 | 減速材・黒鉛 |
| Concrete | 2.0-2.5 | 2.3 | 11 | 建築遮蔽・生体遮蔽 |
| Iron | 7.0-7.9 | 7.86 | 26 | 重遮蔽・構造材 |
| Lead | 10.0-11.4 | 11.34 | 82 | γ線遮蔽・防護板 |
| Aluminum | 2.5-2.8 | 2.70 | 13 | 軽量遮蔽・筐体 |
| Copper | 8.5-9.0 | 8.96 | 29 | 配管遮蔽・熱交換器 |
| Tungsten | 18.0-19.3 | 19.3 | 74 | 高密度遮蔽・コリメータ |
| Air | 0.001-0.002 | 0.00129 | 7.3 | 空間・大気 |
| Water | 0.9-1.1 | 1.0 | 7.4 | 減速・遮蔽・冷却 |
| PyrexGlass | 2.2-2.3 | 2.23 | 10 | 観察窓・光学材料 |
| AcrylicResin | 1.1-1.2 | 1.18 | 6.5 | 透明遮蔽・プラスチック |
| Polyethylene | 0.92-0.97 | 0.95 | 5.4 | 中性子遮蔽・減速材 |
| Soil | 1.5-2.0 | 1.8 | 11 | 地中遮蔽・埋設 |
| VOID | - | 0 | 0 | 真空・空隙・計算境界 |

### **減衰係数データ源**
- **光子**: NIST XCOM データベース
- **中性子**: ENDF/B-VII.1 評価済み核データ
- **エネルギー範囲**: 10 keV - 20 MeV

---

## ☢️ 子孫核種自動追加の物理

### **放射平衡の理論**

#### **永続平衡 (Secular Equilibrium)**
```
条件: T₁/₂(親) >> T₁/₂(子)
関係: A(子) = A(親)
```

#### **過渡平衡 (Transient Equilibrium)**
```
条件: T₁/₂(親) > T₁/₂(子)
関係: A(子) = A(親) × λ(子)/(λ(子)-λ(親))
```

#### **非平衡 (No Equilibrium)**
```
条件: T₁/₂(親) < T₁/₂(子)
関係: 時間依存の複雑な関係
```

### **ICRP-07データベースの活用**
```yaml
データ構造:
- 核種: 1252核種
- 崩壊系列: 完全な系列情報
- 崩壊定数: 高精度データ
- 分岐比: 崩壊経路の確率
```

### **寄与閾値5%の物理的根拠**
- **測定精度**: 一般的な測定器の精度限界
- **規制要求**: 有意な寄与とみなす基準
- **計算効率**: 無視できる寄与の除外

### **実装例: Cs-137の場合**
```yaml
親核種:
  Cs-137:
    半減期: 30.17年
    崩壊: β⁻崩壊

子孫核種:
  Ba-137m:
    半減期: 2.55分
    崩壊: IT (γ線 662 keV)
    平衡時の放射能比: 0.946

自動追加の判定:
- 寄与率: 94.6% > 5% → 自動追加対象
```

---

## 🔄 28メソッドの物理的背景

### **メソッドカテゴリーの物理的意味**

#### **Body操作（3メソッド）**
- **propose**: 新規形状の定義
- **update**: 形状パラメータの変更
- **delete**: 形状の除去

**物理的意味**: 遮蔽体の幾何学的配置

#### **Zone操作（3メソッド）**
- **propose**: 材料割り当て
- **update**: 材料・密度変更
- **delete**: 材料除去

**物理的意味**: 物質分布の定義

#### **Transform操作（3メソッド）**
- **propose**: 座標変換定義
- **update**: 変換パラメータ変更
- **delete**: 変換除去

**物理的意味**: 空間配置の最適化

#### **BuildupFactor操作（4メソッド）**
- **propose**: 係数計算設定
- **update**: 計算パラメータ変更
- **delete**: 係数除外
- **changeOrder**: 計算順序変更

**物理的意味**: 散乱線寄与の精密計算

#### **Source操作（3メソッド）**
- **propose**: 線源配置
- **update**: 線源パラメータ変更
- **delete**: 線源除去

**物理的意味**: 放射線場の定義

#### **Detector操作（3メソッド）**
- **propose**: 評価点設定
- **update**: 位置・条件変更
- **delete**: 評価点除去

**物理的意味**: 線量評価位置

#### **Unit操作（5メソッド）**
- **propose**: 単位系定義
- **get**: 単位系確認
- **update**: 単位変更
- **validateIntegrity**: 整合性確認
- **analyzeConversion**: 変換係数計算

**物理的意味**: 物理量の一貫性保証

#### **その他の操作（3メソッド）**
- **applyChanges**: 変更の確定
- **executeCalculation**: 計算実行
- **resetYaml**: 初期化
- **confirmDaughterNuclides**: 子孫核種確認

**物理的意味**: 計算制御と品質保証

---

## 📊 計算精度と誤差評価

### **統計誤差の評価**

#### **モンテカルロ法との比較**
POKERは決定論的手法のため統計誤差なし
- **利点**: 再現性、高速計算
- **欠点**: 複雑形状での近似誤差

#### **系統誤差の要因**
1. **断面積データの不確かさ**: ±2-5%
2. **ビルドアップ係数の近似**: ±5-10%
3. **幾何形状の離散化**: ±1-3%
4. **カットオフによる打ち切り**: <0.1%

### **推奨精度設定**

| 用途 | カットオフレート | 期待精度 | 計算時間 |
|------|-----------------|----------|----------|
| 概略設計 | 0.01 | ±20% | 短 |
| 詳細設計 | 0.001 | ±10% | 中 |
| 最終評価 | 0.0001 | ±5% | 長 |
| 研究用 | 0.00001 | ±2% | 非常に長 |

---

## 🔍 結果の物理的妥当性確認

### **チェックリスト**

#### **1. 距離減衰の確認**
```
期待値: 線量率 ∝ 1/r²（点線源の場合）
確認方法: 距離を2倍 → 線量率が1/4
```

#### **2. 遮蔽効果の確認**
```
期待値: I/I₀ = e^(-μt)（狭ビームの場合）
確認方法: 半価層での減衰が1/2
```

#### **3. エネルギー依存性**
```
低エネルギー: 光電効果優勢 → 重元素有効
高エネルギー: コンプトン散乱優勢 → 軽元素も有効
```

#### **4. 異常値の判定基準**
- 負の線量値 → 計算エラー
- 10桁以上の変動 → 形状定義エラー
- 距離増加で線量増加 → 配置エラー

---

## 📚 参考文献・規格

### **基準・規格**
- ICRP Publication 116: 外部被ばく換算係数
- ICRP Publication 107: 核崩壊データ
- ANSI/ANS-6.1.1: ガンマ線減衰係数
- ISO 8529: 中性子参照場

### **データベース**
- NIST XCOM: 光子断面積
- ENDF/B-VII.1: 評価済み核データ
- JENDL-4.0: 日本評価済み核データ

### **教科書・文献**
- Shultis & Faw: "Radiation Shielding"
- Chilton et al.: "Principles of Radiation Shielding"
- 日本原子力学会: "放射線遮蔽ハンドブック"

---

**📋 関連マニュアル**
- [ESSENTIAL_GUIDE.md](ESSENTIAL_GUIDE.md): 基本操作
- [QUICK_REFERENCE.md](QUICK_REFERENCE.md): クイックリファレンス
- [INTEGRATION_GUIDE.md](INTEGRATION_GUIDE.md): システム統合
- [RESEARCH_WORKFLOWS.md](RESEARCH_WORKFLOWS.md): 研究ワークフロー
- [TROUBLESHOOTING.md](TROUBLESHOOTING.md): トラブルシューティング